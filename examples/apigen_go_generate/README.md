# API Generator Go Generate Example

This example demonstrates how to use the `apigen` CLI tool with `go generate` to automatically embed API definitions as string constants in your Go code.

## How It Works

### 1. Add go:generate Comment
The `main.go` file includes a `go:generate` comment that invokes the CLI tool:

```go
//go:generate go run github.com/pangobit/agent-sdk/cmd/apigen -file=main.go -methods=ProcessUserData,ValidateInput -out=api_gen.go -const=DataProcessorAPIJSON
```

### 2. CLI Tool Invocation
The command uses the `apigen` CLI tool with parameters:
- `-file=main.go`: Analyze the main.go file
- `-methods=ProcessUserData,ValidateInput`: Include only these specific methods
- `-out=api_gen.go`: Output file name
- `-const=DataProcessorAPIJSON`: Name of the generated constant

### 3. Generated File
Running `go generate` creates `api_gen.go` containing:

```go
// Code generated by apigen; DO NOT EDIT.
// This file contains the API description for main

package main

// DataProcessorAPIJSON contains the JSON API description for this file
const DataProcessorAPIJSON = `{ ... JSON content ... }`
```

### 4. Runtime Usage
The generated constant can be used directly in your application:

```go
fmt.Println("API Description:", DataProcessorAPIJSON)
```

## Running the Example

### Generate the API file:
```bash
cd examples/apigen_go_generate
go generate
```

### Run the application:
```bash
go run main.go api_gen.go
```

## CLI Tool Options

The `apigen` CLI tool supports various filtering options:

- **Method filtering**: `-methods=Method1,Method2,Method3`
- **Prefix filtering**: `-prefix=Handle` (include methods starting with "Handle")
- **Suffix filtering**: `-suffix=Handler` (include methods ending with "Handler")
- **Content filtering**: `-contains=Process` (include methods containing "Process")

## Features Demonstrated

- **CLI Tool Integration**: Using the reusable `apigen` command
- **go:generate Compatibility**: Automatic code generation during build
- **Embedded API Definitions**: API descriptions available as runtime string constants
- **Struct Field Extraction**: Complete type information including nested struct fields
- **Struct Tag Annotations**: JSON field names, validation rules, and binding information